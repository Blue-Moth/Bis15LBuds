runApp('GitHub/Bis15LBuds/Virus_Plot_iteration_3-Point_and_Click-with_Theme.R')
runApp('GitHub/Bis15LBuds/Virus_Plot_iteration_3-Point_and_Click-with_Theme.R')
runApp('GitHub/Bis15LBuds/Virus_Plot_iteration_3-Point_and_Click-with_Theme.R')
runApp('GitHub/Bis15LBuds/Virus_Plot_iteration_3-Point_and_Click-with_Theme.R')
runApp('GitHub/Bis15LBuds/Virus_Plot_iteration_3-Point_and_Click-with_Theme.R')
runApp('GitHub/Bis15LBuds/Virus_Plot_iteration_3-Point_and_Click-with_Theme.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
knitr::opts_chunk$set(echo = TRUE)
?brushedPoints
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
rlang
rlang::last_error()
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
virus_clean2%>%
ggplot(aes(x=host, y=gene_to_genome_ratio))+
geom_col
virus_clean2<-virus%>%
separate('Host', into=c("host_type_1", "host_type_2", "host_type_3"), sep=",")%>%
pivot_longer(host_type_1:host_type_3,
names_to="host_num",
values_to="host_type",
values_drop_na=T)%>%
separate('Organism Groups', into=c("domain", "kingdom", "subgroup"), sep=";")%>%
filter(Level=="Complete" & (host_type=="human" | host_type=="land plants"))%>%
select('host_type', 'Organism Name', 'kingdom','subgroup', 'Size(Mb)', 'GC%', 'Genes','Level')%>%
rename(organism_name='Organism Name', kingdom=kingdom, subgroup=subgroup, level="Level", size_mb='Size(Mb)', perc_gc='GC%', host=host_type, genes_num='Genes')%>%
mutate(gene_to_genome_ratio=genes_num/size_mb)%>%
arrange(host)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(janitor)
virus<-readr::read_csv("data/viruses.csv")
virus
virus$Host<-as.factor(virus$Host)
levels(virus$Host)
virus_c<-virus%>%
separate('Host', into=c("host_type_1", "host_type_2", "host_type_3"), sep=",")
virus_c
virus_c$host_type_1<-as.factor(virus_c$host_type_1)
virus_c$host_type_2<-as.factor(virus_c$host_type_2)
virus_c$host_type_3<-as.factor(virus_c$host_type_3)
levels(virus_c$host_type_1)
levels(virus_c$host_type_2)
levels(virus_c$host_type_3)
virus_clong<-virus_c%>%
pivot_longer(host_type_1:host_type_3,
names_to="host_num",
values_to="host_type",
values_drop_na=T)
virus_clong
virus_clean<-virus_clong%>%
separate('Organism Groups', into=c("domain", "kingdom", "subgroup"), sep=";")%>%
filter(Level=="Complete" & (host_type=="human" | host_type=="land plants"))%>%
select('host_type', 'Organism Name', 'kingdom','subgroup', 'Size(Mb)', 'GC%', 'Genes','Level')%>%
rename(organism_name='Organism Name', kingdom=kingdom, subgroup=subgroup, level="Level", size_mb='Size(Mb)', perc_gc='GC%', host=host_type, genes_num='Genes')%>%
mutate(gene_to_genome_ratio=genes_num/size_mb)%>%
arrange(host)
virus_clean
virus_clean%>%
select(size_mb)%>%
summary()
virus_clean%>%
ggplot(aes(x=size_mb, fill=host, color=kingdom))+
geom_histogram(alpha=0.25)+
scale_y_log10()
virus_clean%>%
ggplot(aes(x=size_mb, y=kingdom, color=host, size=perc_gc))+
geom_jitter(alpha=0.25)+
coord_flip()+
theme_solarized()+
scale_color_manual(values=colors)+
theme(legend.position="top",
axis.text.x=element_text(angle=60, hjust=1))
virus_clean2<-virus%>%
separate('Host', into=c("host_type_1", "host_type_2", "host_type_3"), sep=",")%>%
pivot_longer(host_type_1:host_type_3,
names_to="host_num",
values_to="host_type",
values_drop_na=T)%>%
separate('Organism Groups', into=c("domain", "kingdom", "subgroup"), sep=";")%>%
filter(Level=="Complete" & (host_type=="human" | host_type=="land plants"))%>%
select('host_type', 'Organism Name', 'kingdom','subgroup', 'Size(Mb)', 'GC%', 'Genes','Level')%>%
rename(organism_name='Organism Name', kingdom=kingdom, subgroup=subgroup, level="Level", size_mb='Size(Mb)', perc_gc='GC%', host=host_type, genes_num='Genes')%>%
mutate(gene_to_genome_ratio=genes_num/size_mb)%>%
arrange(host)
virus_clean2
virus_clean2%>%
ggplot(aes(x=host, y=gene_to_genome_ratio))+
geom_col
virus_clean2%>%
ggplot(aes(x=host, y=gene_to_genome_ratio))+
geom_col()
virus_clean2%>%
group_by(host)%>%
ggplot(aes(x=host, y=gene_to_genome_ratio))+
geom_col()
virus_clean2%>%
group_by(host)%>%
ggplot(aes(x=host, y=gene_to_genome_ratio))+
geom_box()
virus_clean2%>%
group_by(host)%>%
ggplot(aes(x=host, y=gene_to_genome_ratio))+
geom_boxplot()
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
ggplot(virus_clean2, aes(x=genes_num, y=size_mb, size=perc_gc, color=host, group=host))+
geom_jitter(alpha=0.25)+
facet_grid(. ~kingdom)+
#aesthetics
theme_solarized()+
theme(legend.position="top",
axis.text.x=element_text(angle=60, hjust=1))+
scale_size(range = c(0.1, 10),
guide = "none")
#labels
labs(x="Number of Genes",
y="Genome Size (Mb)",
size="Percent GC",
color="Host")+
#text
geom_text(aes(x = genes_num, y =  + 3, label = organism_name),
color = "grey50",
data = filter(virus_clean2, size_mb > 100000 | organism_name %in% c("Zika virus", "West Nile virus", "Rabies lyssavirus")))
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata_nearlyfinaldraft.R')
runApp('GitHub/Bis15LBuds/shinyapp_try1_justmbdata_nearlyfinaldraft.R')
library(shiny); runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
library(shiny); runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/virus-app_workingdraft.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
runApp('GitHub/Bis15LBuds/nearlynearlyfinal.R')
setwd("~/GitHub/Bis15LBuds")
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
runApp('nearlynearlyfinal.R')
library(shiny); runApp('final_virus_app_AH.R')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(ggthemes)
library(paletteer)
library(ggplot2)
library(RColorBrewer)
colors<- LaCroixColoR::lacroix_palette("Pamplemousse", type = "discrete")
viruses <- readr::read_csv("viruses.csv") %>% clean_names()
viruses <- readr::read_csv("data"/"viruses.csv") %>% clean_names()
viruses <- readr::read_csv("data/viruses.csv") %>% clean_names()
viruses <- viruses %>%
filter(level == "Complete") %>%
select(organism_name, organism_groups, level, size_mb, gc_percent, host, genes)
viruses<-viruses %>%
separate(organism_groups, into = c("domain", "group", "family"),sep=";")
arch_bact <- viruses %>%
filter(host == "archaea"|host == "bacteria")
dat <- arch_bact %>%
group_by(host) %>%
summarize(size = mean(size_mb, na.rm = T))
arch_bact %>%
group_by(host) %>%
summarize(size = mean(size_mb, na.rm = T)) %>%
ggplot(aes(x=host, y=size, fill=host))+
geom_col()+
theme_solarized()+
scale_fill_manual(values=colors)+
labs(title = "Genome Size of Viruses by Host",
x="Host",
y="Genome Size (Mb)")
data <- arch_bact %>%
group_by(host) %>%
summarize(size = mean(size_mb, na.rm = T),
gc = mean(gc_percent, na.rm = T),
gene = mean(genes, na.rm = T))
arch_bact %>%
group_by(host) %>%
summarize(size = mean(size_mb, na.rm = T)) %>%
ggplot(aes(x=host, y=size, fill=host))+
geom_col()+
theme_solarized()+
scale_fill_manual(values=colors)+
labs(title = "Genome Size of Viruses by Host",
x="Host",
y="Genome Size (Mb)")
data %>%
ggplot(aes(x=host, y=size, fill=host))+
geom_col()+
theme_solarized()+
scale_fill_manual(values=colors)+
labs(title = "Genome Size of Viruses by Host",
x="Host",
y="Genome Size (Mb)")
arch_bact %>%
ggplot(aes(x=host, y=gc, fill=host)+
geom_col()+
theme_solarized()+
scale_fill_manual(values=colors)+
labs(title = "Genome Size of Viruses by Host",
x="Host",
y="Genome Size (Mb)")
data %>%
ggplot(aes(x=host, y=gc, fill=host)+
geom_col()+
theme_solarized()+
scale_fill_manual(values=colors)+
labs(title = "Genome Size of Viruses by Host",
x="Host",
y="Genome Size (Mb)")
data %>%
ggplot(aes(x=host, y=gc, fill=host))+
geom_col()+
theme_solarized()+
scale_fill_manual(values=colors)+
labs(title = "Genome Size of Viruses by Host",
x="Host",
y="Genome Size (Mb)")
data %>%
ggplot(aes(x=host, y=gc, fill=host))+
geom_col()+
theme_solarized()+
scale_fill_manual(values=colors)+
labs(title = "GC Content of Viruses by Host",
x="Host",
y="GC Content (Percent)")
data %>%
ggplot(aes(x=host, y=gene, fill=host))+
geom_col()+
theme_solarized()+
scale_fill_manual(values=colors)+
labs(title = "Number of Genes in Virus Genomes by Host",
x="Host",
y="Number of Genes")
arch_bact %>%
filter(genes != 0) %>%
mutate(gene_mb_ratio = genes/size_mb) %>%
group_by(host) %>%
summarize(gene_content = mean(gene_mb_ratio, na.rm = T)) %>%
ggplot(aes(x=host, y=gene_content, fill=host))+
geom_col()+
theme_solarized()+
scale_fill_manual(values=colors)+
labs(title = "Gene to Genome Size Ratio by Host",
x="Host",
y="Genes to Genome Size (Genes/Mb")
arch_bact %>%
filter(genes != 0) %>%
mutate(gene_mb_ratio = genes/size_mb) %>%
group_by(host) %>%
summarize(gene_content = mean(gene_mb_ratio, na.rm = T)) %>%
ggplot(aes(x=host, y=gene_content, fill=host))+
geom_col()+
theme_solarized()+
scale_fill_manual(values=colors)+
labs(title = "Gene to Genome Size Ratio by Host",
x="Host",
y="Genes to Genome Size (Genes/Mb)")
