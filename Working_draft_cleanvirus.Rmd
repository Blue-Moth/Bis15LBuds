---
title: 'Viral Comparison: Group Project'
author: "Aryss Hearne"
date: "3/6/2021"
output: 
  html_document: 
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Hypothesis: Viruses that target land plants will exhibit higher gene load and higher genome lengths than viruses that target humans. 

### Load libraries for tidying
```{r}
library(tidyverse)
library(here)
library(janitor)
```

### Load relevant csv

```{r}
virus<-readr::read_csv("data/viruses.csv")
```

### Inspect

```{r}
virus
```

### Are there any viruses which attack humans AND land plants?
```{r}
virus$Host<-as.factor(virus$Host)
levels(virus$Host)
```

### Fix the multiple hosts per host category nonsense.
```{r}
virus_c<-virus%>%
  separate('Host', into=c("host_type_1", "host_type_2", "host_type_3"), sep=",")
virus_c
```

### Checking my work
```{r}
virus_c$host_type_1<-as.factor(virus_c$host_type_1)
virus_c$host_type_2<-as.factor(virus_c$host_type_2)
virus_c$host_type_3<-as.factor(virus_c$host_type_3)
levels(virus_c$host_type_1)
```

```{r}
levels(virus_c$host_type_2)
```
```{r}
levels(virus_c$host_type_3)
```
```{r}
virus_clong<-virus_c%>%
  pivot_longer(host_type_1:host_type_3,
               names_to="host_num",
               values_to="host_type",
               values_drop_na=T)
virus_clong
```



### Filter for only Complete Genome data, separate Organism Groups into difft columns, reorder, rename

```{r}
virus_clean<-virus_clong%>%
  separate('Organism Groups', into=c("domain", "kingdom", "subgroup"), sep=";")%>%
  filter(Level=="Complete" & (host_type=="human" | host_type=="land plants"))%>%
  select('host_type', 'Organism Name', 'kingdom','subgroup', 'Size(Mb)', 'GC%', 'Genes','Level')%>%
  rename(organism_name='Organism Name', kingdom=kingdom, subgroup=subgroup, level="Level", size_mb='Size(Mb)', perc_gc='GC%', host=host_type, genes_num='Genes')%>%
  arrange(host)
virus_clean
```

#### Figuring out the limits of the data

```{r}
virus_clean%>%
  select(size_mb)%>%
  summary()
```


```{r}
virus_clean%>%
  ggplot(aes(x=size_mb, fill=host, color=kingdom))+
  geom_histogram(alpha=0.25)+
  scale_y_log10()
```


```{r}
library(shiny)
library(shinydashboard)
```

